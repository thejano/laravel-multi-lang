import{_ as n,c as a,a as t,o as e}from"./app-DeSQkU7Q.js";const p={};function o(c,s){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="testing-qa" tabindex="-1"><a class="header-anchor" href="#testing-qa"><span>Testing &amp; QA</span></a></h1><p>Translations are part of your domain, so they deserve first-class test coverage. This guide outlines how to seed translations in tests, leverage the package’s factories, and design QA workflows that keep localisation healthy.</p><hr><h2 id="factories-seeds" tabindex="-1"><a class="header-anchor" href="#factories-seeds"><span>Factories &amp; seeds</span></a></h2><p>The package ships with <code>TheJano\\MultiLang\\Database\\Factories\\TranslationFactory</code>, making it easy to stub translations:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token keyword">use</span> <span class="token package">TheJano<span class="token punctuation">\\</span>MultiLang<span class="token punctuation">\\</span>Models<span class="token punctuation">\\</span>Translation</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">TheJano<span class="token punctuation">\\</span>MultiLang<span class="token punctuation">\\</span>Tests<span class="token punctuation">\\</span>Fixtures<span class="token punctuation">\\</span>TestPost</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name static-context">Translation</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;translatable_type&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;translatable_id&#39;</span>   <span class="token operator">=&gt;</span> <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;locale&#39;</span>            <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;ckb&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;field&#39;</span>             <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;translation&#39;</span>       <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Alternatively, rely on the trait helpers inside your test setup:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">post</span> <span class="token operator">=</span> <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">post</span><span class="token operator">-&gt;</span><span class="token function">setTranslationsBatch</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">        <span class="token string single-quoted-string">&#39;ckb&#39;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">&#39;ar&#39;</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;title&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;عنوان&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="sample-assertions" tabindex="-1"><a class="header-anchor" href="#sample-assertions"><span>Sample assertions</span></a></h2><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;returns translated title for current locale&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$post</span> <span class="token operator">=</span> <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token function">setTranslation</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ckb&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name static-context">App</span><span class="token operator">::</span><span class="token function">setLocale</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;ckb&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token property">title</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ar&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filters posts by translated title&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setTranslation</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ckb&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setTranslation</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;عنوان&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ar&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$matches</span> <span class="token operator">=</span> <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">whereTranslate</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;title&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ناونیشان&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ckb&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">toHaveCount</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="cache-aware-testing" tabindex="-1"><a class="header-anchor" href="#cache-aware-testing"><span>Cache-aware testing</span></a></h2><ul><li>During tests, the default per-model cache is enough. If you configure a shared cache store, call <code>Post::resetTranslationCacheStore()</code> in your <code>setUp()</code> method to keep the environment deterministic.</li><li>After imports or bulk updates in tests, call <code>$post-&gt;refresh()</code> to repopulate relationships and caches.</li></ul><hr><h2 id="testing-cli-workflows" tabindex="-1"><a class="header-anchor" href="#testing-cli-workflows"><span>Testing CLI workflows</span></a></h2><p>Use Laravel’s built-in command testing helpers:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token function">test</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;audit command reports missing translations&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// intentionally missing locale</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">artisan</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;multi-lang:audit&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string single-quoted-string">&#39;model&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">TestPost</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">&#39;--locales&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;ckb,ar&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">&#39;--detailed&#39;</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">expectsOutputToContain</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Missing translations&#39;</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token operator">-&gt;</span><span class="token function">assertExitCode</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For export/import commands, write fixtures to <code>storage/testing</code> and clean them up inside the test.</p><hr><h2 id="qa-workflows" tabindex="-1"><a class="header-anchor" href="#qa-workflows"><span>QA workflows</span></a></h2><ul><li><strong>CI checks</strong>: run <code>php artisan multi-lang:audit</code> as part of your pipeline. Fail the build if the exit code is non-zero.</li><li><strong>Smoke tests</strong>: ensure critical views render translations for the locales you support (<code>trans_model()</code> assertions inside feature tests).</li><li><strong>Percy / screenshot tests</strong>: pair translations with visual diffs to catch layout regressions (especially for RTL languages).</li><li><strong>Performance tests</strong>: re-run the included Pest <code>PerformanceTest</code> suite after major refactors to ensure eager loading and caching still work as expected.</li></ul><p>With testing covered, you’re ready to ship confident localisation changes alongside the rest of your application.</p>`,23)])])}const l=n(p,[["render",o]]),u=JSON.parse('{"path":"/guide/testing.html","title":"Testing & QA","lang":"en-US","frontmatter":{"title":"Testing & QA"},"git":{"updatedTime":1762818033000,"contributors":[{"name":"Pshtiwan Mahmood","username":"","email":"kardoey@gmail.com","commits":1}],"changelog":[{"hash":"6f1865987fc5bf0bd26664c58f95973ad57c7533","time":1762818033000,"email":"kardoey@gmail.com","author":"Pshtiwan Mahmood","message":"2nd Version"}]},"filePathRelative":"guide/testing.md"}');export{l as comp,u as data};
